<html>
	<head>
		<meta http-equiv="content-type" content="text/html; charset=utf-8" />
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.1/jquery.min.js"></script>
		<script src="https://apprtc.appspot.com/js/adapter.js"></script>
		<script src='https://cdn.firebase.com/v0/firebase.js'></script>
		<script src="js/common.js" type="text/javascript"></script>
		<script src="js/p2p.js" type="text/javascript"></script>
		<script src="js/trader.js" type="text/javascript"></script>

		<link href="./common.css" rel="stylesheet" type="text/css" />

		<title>Trader</title>
	</head>
	<body>
		<h2>Address</h2><input readonly id="address"><button id="listen">Listen</button>
		<h2>Connect</h2><input id="connect"><button id="connect">Connect</button>
		<h2>Comm</h2>
		<input id="send">
		<button id="send">Send</button>
		<div id="recv"></div>
		<script>
			var s = new RTCSocket();
			function recv(msg)
			{
				$('div#recv').html($('div#recv').html() + msg.data + '<br/>');
			}
			$(document).ready(function ()
			{
				$('button#send').click(function()
				{
					s.send($('input#send').val());
					$('input#send').val('');
				});
				$('button#listen').click(function()
				{
					var id = s.listen(function(f, o){ s.accept(f, o, recv, function() { $('input#address').val(''); }); } );
					$('#address').val(id);
				});
	
				$('button#connect').click(function()
				{
					s.connect($('input#connect').val(), recv, function() { $('input#connect').val(''); });
				});
			});
		</script>
	</body>
</html>
